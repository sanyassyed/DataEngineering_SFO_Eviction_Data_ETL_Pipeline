types.StructType([
    types.StructField(':id', types.StringType(), True), 
    types.StructField(':created_at', types.TimestampType(), True), 
    types.StructField(':updated_at', types.TimestampType(), True), 
    types.StructField(':version', types.StringType(), True), 
    types.StructField(':@computed_region_6qbp_sg9q', types.StringType(), True), 
    types.StructField(':@computed_region_qgnn_b9vv', types.StringType(), True), 
    types.StructField(':@computed_region_26cr_cadq', types.StringType(), True), 
    types.StructField(':@computed_region_ajp5_b2md', types.StringType(), True), 
    types.StructField(':@computed_region_fyvs_ahh9', types.StringType(), True), 
    types.StructField(':@computed_region_p5aj_wyqh', types.StringType(), True), 
    types.StructField(':@computed_region_rxqg_mtj9', types.StringType(), True), 
    types.StructField(':@computed_region_yftq_j783', types.StringType(), True), 
    types.StructField(':@computed_region_bh8s_q3mv', types.StringType(), True), 
    types.StructField(':@computed_region_6pnf_4xz7', types.StringType(), True), 
    types.StructField(':@computed_region_jwn9_ihcz', types.StringType(), True), 
    types.StructField('eviction_id', types.StringType(), True), 
    types.StructField('address', types.StringType(), True), 
    types.StructField('city', types.StringType(), True), 
    types.StructField('state', types.StringType(), True), 
    types.StructField('zip', types.IntegerType(), True), 
    types.StructField('file_date', types.DateType(), True), 
    types.StructField('non_payment', types.BooleanType(), True), 
    types.StructField('breach', types.BooleanType(), True), 
    types.StructField('nuisance', types.BooleanType(), True), 
    types.StructField('illegal_use', types.BooleanType(), True), 
    types.StructField('failure_to_sign_renewal', types.BooleanType(), True), 
    types.StructField('access_denial', types.BooleanType(), True), 
    types.StructField('unapproved_subtenant', types.BooleanType(), True), 
    types.StructField('owner_move_in', types.BooleanType(), True), 
    types.StructField('demolition', types.BooleanType(), True), 
    types.StructField('capital_improvement', types.BooleanType(), True), 
    types.StructField('substantial_rehab', types.BooleanType(), True), 
    types.StructField('ellis_act_withdrawal', types.BooleanType(), True), 
    types.StructField('condo_conversion', types.BooleanType(), True), 
    types.StructField('roommate_same_unit', types.BooleanType(), True), 
    types.StructField('other_cause', types.BooleanType(), True), 
    types.StructField('late_payments', types.BooleanType(), True), 
    types.StructField('lead_remediation', types.BooleanType(), True), 
    types.StructField('development', types.BooleanType(), True), 
    types.StructField('good_samaritan_ends', types.BooleanType(), True), 
    types.StructField('supervisor_district', types.IntegerType(), True), 
    types.StructField('neighborhood', types.StringType(), True), 
    types.StructField('client_location', types.MapType(types.StringType(), types.StringType(), True), True), 
    types.StructField('shape', types.MapType(types.StringType(), types.StringType(), True), True), 
    types.StructField(':@computed_region_9jxd_iqea', types.StringType(), True), 
    types.StructField(':@computed_region_6ezc_tdp2', types.StringType(), True), 
    types.StructField(':@computed_region_h4ep_8xdi', types.StringType(), True), 
    types.StructField(':@computed_region_pigm_ib2e', types.StringType(), True), 
    types.StructField('constraints_date', types.StringType(), True)])



--column names
eviction_id , 
address , 
city , 
state , 
zip , 
file_date , 
non_payment , 
breach , 
nuisance , 
illegal_use , 
failure_to_sign_renewal , 
access_denial , 
unapproved_subtenant , 
owner_move_in , 
demolition , 
capital_improvement , 
substantial_rehab , 
ellis_act_withdrawal , 
condo_conversion , 
roommate_same_unit , 
other_cause , 
late_payments , 
lead_remediation , 
development , 
good_samaritan_ends , 
constraints_date , 
supervisor_district , 
neighborhood , 
created_at , 
updated_at , 
latitude , 
longitude



cast( ({{dbt_utils.surrogate_key(['eviction_id', (cast('file_date' as string))])}}) as string) as case_id,


({{dbt_utils.surrogate_key(['eviction_id', (cast('file_date' as string))])}})

(cast('file_date' as string))

cast( ({{dbt_utils.surrogate_key(['eviction_id', file_date])}}) as string) as case_id,





cast( ({{ dbt_utils.surrogate_key(['eviction_id', date_trunc('day', dbt_utils.safe_cast('updated_at' as api.Column.translate_type("timestamp")))])}}) as string) as case_id,



BACKUP:
--here we are using the date_trunc function from dbt_uils hence the syntax is different
--cast( ({{dbt_utils.surrogate_key(['eviction_id', date_trunc('day', dbt_utils.safe_cast('updated_at', api.Column.translate_type('timestamp')))])}}) as string) as case_id,
--here we are using the date_truc function from BQ hence the syntax is different
--Not using this as I've alreasy eliminated duplicates of these by using de-duplication above